{"__html":"<h2 id=\"8b1dd3a83354a26be455048c7e52644b\">导航栏和左侧菜单集成JSSDK</h2>\n<h4 id=\"d9e716bbabfeb32c6fcf213b27b086cb\">说明</h4>\n<p>为了统一运营平台的各个业务方系统的导航栏和左侧菜单的风格</p>\n<h4 id=\"b956afc6fa8c5e7b96feb880427fa9d5\">1、引入导航栏和左侧菜单</h4>\n<ul>\n<li>在页面的入口引入JSSDK</li>\n</ul>\n<pre><code class=\"language-js\">&lt;script src=&quot;{PATH_ENV}/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;</code></pre>\n<ul>\n<li>本地环境开发阶段</li>\n</ul>\n<pre><code class=\"language-js\">\n&lt;script src=&quot;http://dev-work.eju.com/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;\n</code></pre>\n<ul>\n<li>部署到生产环境阶段</li>\n</ul>\n<pre><code class=\"language-js\">// 开发环境\n&lt;script src=&quot;http://dev-work.eju.com/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;\n\n// 测试环境\n&lt;script src=&quot;http://work-test.eju.com/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;\n\n// 正式环境\n&lt;script src=&quot;http://work.eju.com/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;</code></pre>\n<h4 id=\"70158491e34a25b39b7200f8b45df9a1\">2、配置左侧导航栏入口和左侧菜单</h4>\n<p>需要有配置菜单权限的人员登录运营平台进行配置</p>\n<blockquote>\n<p>开发环境：<a href=\"http://dev-work.eju.com/\">http://dev-work.eju.com/</a></p>\n</blockquote>\n<blockquote>\n<p>测试环境：<a href=\"http://work-test.eju.com/\">http://work-test.eju.com/</a></p>\n</blockquote>\n<blockquote>\n<p>正式环境：<a href=\"http://work.eju.com/\">http://work.eju.com/</a></p>\n</blockquote>\n<h4 id=\"50ac0d2f88debd307857fd675a31fa20\">3、使用示例</h4>\n<pre><code class=\"language-js\">new window.ETCOPTSDK()</code></pre>\n<h5 id=\"628c2da6345dbcb68240a5e9eeb1a42c\">执行成功示例</h5>\n<p>便会在当前页，注入导航栏与左侧菜单</p>\n<blockquote>\n<p>菜单数据根据账号，业务，权限等不同而不同</p>\n</blockquote>\n<p><img src=\"./1.png\" alt=\"gateway\"></p>\n<p><img src=\"./2.png\" alt=\"gateway\"></p>\n<h4 id=\"e6bc18b5658db5f4b5bc10ab579666a6\">4、调试问题</h4>\n<ul>\n<li><p>JS资源加载未完成前，引用了JSSDK</p>\n</li>\n<li><p>参考6、基本示例</p>\n<pre><code></code></pre>\n</li>\n<li><p>本地开发调试JSSDK请求的接口存在跨域问题</p>\n</li>\n</ul>\n<pre><code class=\"language-js\">// 本地开发调试时，在入口引用\n// dev-work.eju.com服务端已做跨域处理\n// 一般调试时情况都正常，如遇到问题，请联系我们\n&lt;script src=&quot;http://dev-work.eju.com/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;\n// 出现跨域问题时，本地开发环境运行时，js资源引入问题\n// 如\n&lt;script src=&quot;http://work-test.eju.com/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;\n// 或\n&lt;script src=&quot;http://work.eju.com/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;\n// 如上两种情况，本地调试时或发布到生产环境时，引入js与生产环境域名不一致时，都会出现跨域报错问题\n// 本地调试时解决方式\n// 设置服务代理\napp.use(\n  &#39;/api&#39;,\n  createProxyMiddleware({\n    // target: &#39;http://work.eju.com&#39;,\n    // target: &#39;http://ev-work.eju.com&#39;,\n    target: &#39;http://work-test.eju.com&#39;,\n    changeOrigin: true,\n  })\n)\n// 如果本地调试引入正常，但生产环境出现问题，请检查引入的ETCOPTSDK JSSDK 资源路径是否与线上环境资源是否一致</code></pre>\n<ul>\n<li>调试时，提示token无效或失效问题</li>\n</ul>\n<pre><code class=\"language-js\">/**\n * 如果需要获取在dev环境配置的菜单数据\n * 请先访问 http://dev-work.eju.com/ 登录成功后\n * 打开开发者工具，将 localStorage 中\n * pro__Access-Token 字段及value 复制到本地服务器环境的localStorage中\n * pro__Login_Userinfo 字段及value 复制到本地服务器环境的localStorage中\n * 操作至此，刷新即可\n * 若本地调试时，需要获取其他环境配置的菜单数据，操作同上 \n * 开发环境：http://dev-work.eju.com/\n * 测试环境：http://work-test.eju.com/\n * 正式环境：http://work.eju.com/\n *／</code></pre>\n<h4 id=\"ba1ff7d02ec429e2684095029fb1b5d7\">5、JSSDK资源引入建议</h4>\n<h5 id=\"d7381dddd4a6156c9d86cfd87d0ae982\">如果你的项目生产环境地址属于以下几种</h5>\n<blockquote>\n<p>开发环境：<a href=\"http://dev-work.eju.com/\">http://dev-work.eju.com/</a></p>\n</blockquote>\n<blockquote>\n<p>测试环境：<a href=\"http://work-test.eju.com/\">http://work-test.eju.com/</a></p>\n</blockquote>\n<blockquote>\n<p>正式环境：<a href=\"http://work.eju.com/\">http://work.eju.com/</a></p>\n</blockquote>\n<p>建议部署到生产环境时，JSSDK资源引入方式调整为</p>\n<pre><code class=\"language-js\">// 使用相对路径引入\n// 避免部署不同生产环境时，引入资源环境不一致问题\n&lt;script src=&quot;/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;</code></pre>\n<h5 id=\"9a65aecef0d96919d1c8ae99464172ba\">其它情况引入方式</h5>\n<pre><code class=\"language-js\">// 开发环境\n&lt;script src=&quot;http://dev-work.eju.com/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;\n// 测试环境\n&lt;script src=&quot;http://work-test.eju.com/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;\n// 正式环境\n&lt;script src=&quot;http://work.eju.com/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;</code></pre>\n<h4 id=\"99382588a86fb00ffabbd75bf766491c\">6、基本示例</h4>\n<pre><code class=\"language-js\">// 引入js\n// index.html\n// 开发环境\n&lt;script src=&quot;http://dev-work.eju.com/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;\n// 测试环境\n// &lt;script src=&quot;http://work-test.eju.com/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;\n// 正式环境\n// &lt;script src=&quot;http://work.eju.com/etc/ETCOPTSDK.min.js&quot;&gt;&lt;/script&gt;\n\nlet ETCOPTSDKTime\nlet timeOrder = 10\nfunction isETCOPTSDKFunc(cb) {\n  if (!timeOrder) {\n    console.error(&#39;未找到方法ETCOPTSDK, 请检查引入状态，并刷新重试&#39;);\n    return ETCOPTSDKTime &amp;&amp; clearTimeout(ETCOPTSDKTime)\n  }\n  if (Object.hasOwnProperty.call(window, &#39;ETCOPTSDK&#39;)) {\n    cb &amp;&amp; cb()\n    return ETCOPTSDKTime &amp;&amp; clearTimeout(ETCOPTSDKTime)\n  }\n  ETCOPTSDKTime = setTimeout(() =&gt; {\n    timeOrder -= 1\n    isETCOPTSDKFunc(cb)\n  }, 300)\n}\n\n// 调用sdk\n// index.js\nisETCOPTSDKFunc(function() {\n  new window.ETCOPTSDK()\n})\n</code></pre>\n","key":"31dff50aedceaa2ff90defe31f203e2e","fileName":"__inner-docs_ETC运营平台web端集成文档_导航栏和左侧菜单集成JSSDK.json","mtimeMs":1635130711000,"birthtimeMs":1625127790000}